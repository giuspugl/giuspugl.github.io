<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>cloudmodel.MCMole3D &mdash; MCMole3D alpha documentation</title>
    
    <link rel="stylesheet" href="../../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     'alpha',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="MCMole3D alpha documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
        <div class="headertitle"><a
          href="../../index.html">MCMole3D</a></div>
        <div class="rel">
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for cloudmodel.MCMole3D</h1><div class="highlight"><pre>
<span class="c">#</span>
<span class="c">#   MCMOLE3D.PY</span>
<span class="c">#   classes to simulate molecular clouds in Milky Way</span>
<span class="c">#</span>
<span class="c">#   date: 2016-12-02</span>
<span class="c">#   author: GIUSEPPE PUGLISI</span>
<span class="c">#</span>
<span class="c">#   Copyright (C) 2016   Giuseppe Puglisi    giuspugl@sissa.it</span>
<span class="c">#</span>


<span class="kn">import</span> <span class="nn">h5py</span> <span class="kn">as</span> <span class="nn">h5</span>
<span class="kn">import</span> <span class="nn">healpy</span> <span class="kn">as</span> <span class="nn">hp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="kn">as</span> <span class="nn">mtick</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">MultipleLocator</span><span class="p">,</span> <span class="n">FormatStrFormatter</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span><span class="p">,</span><span class="n">gaussian_kde</span><span class="p">,</span><span class="n">uniform</span>
<span class="kn">from</span>  <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">histogram2d</span>
<span class="kn">import</span> <span class="nn">astropy.units</span>  <span class="kn">as</span> <span class="nn">u</span>
<span class="kn">import</span> <span class="nn">astropy.coordinates</span>  <span class="kn">as</span> <span class="nn">coord</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">log_spiral_radial_distribution2</span>


<div class="viewcode-block" id="Cloud"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud">[docs]</a><span class="k">class</span> <span class="nc">Cloud</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Object encoding the properties of each cloud, i.e.:</span>

<span class="sd">	- :math:`(R,\phi, z )` the Galactic coordinates of the center of the cloud, in units of :math:`(kpc, rad, kpc)`;</span>
<span class="sd">	- :math:`(d_{\odot},\ell, b )` the position referred in the Solar system frame in units of :math:`(kpc, rad,rad)`;</span>
<span class="sd">	- :math:`\epsilon`, the emissivity in the center in units of :math:`K km/s`</span>
<span class="sd">	- :math:`L` the cloud size in units of :math:`pc`</span>
<span class="sd">	&quot;&quot;&quot;</span>
<div class="viewcode-block" id="Cloud.assign_sun_coord"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud.assign_sun_coord">[docs]</a>	<span class="k">def</span> <span class="nf">assign_sun_coord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">latit</span><span class="p">,</span><span class="n">longit</span><span class="p">):</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">has_suncoord</span><span class="o">=</span><span class="bp">True</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">X_sun</span><span class="o">=</span><span class="p">[</span><span class="n">d</span><span class="p">,</span><span class="n">latit</span><span class="p">,</span><span class="n">longit</span><span class="p">]</span>
		<span class="k">pass</span></div>
<div class="viewcode-block" id="Cloud.emissivity"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud.emissivity">[docs]</a>	<span class="k">def</span> <span class="nf">emissivity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		replicating the profile in  eq.(3) of `Puglisi+ 2017 &lt;http://arxiv.org/abs/1701.07856&gt;`_</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">A</span> 	<span class="o">=</span>	<span class="nb">globals</span><span class="p">()[</span><span class="s">&#39;emiss_params&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">R0</span>  <span class="o">=</span>	<span class="nb">globals</span><span class="p">()[</span><span class="s">&#39;emiss_params&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
		<span class="k">return</span> <span class="n">A</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">R</span><span class="o">/</span><span class="n">R0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Cloud.print_cloudinfo"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud.print_cloudinfo">[docs]</a>	<span class="k">def</span> <span class="nf">print_cloudinfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_suncoord</span><span class="p">:</span>
			<span class="k">print</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s"> </span><span class="se">\t</span><span class="s"> </span><span class="si">%g</span><span class="s"> </span><span class="se">\t</span><span class="s"> </span><span class="si">%g</span><span class="s"> </span><span class="se">\t</span><span class="s"> </span><span class="si">%g</span><span class="s"> </span><span class="se">\t</span><span class="s"> </span><span class="si">%g</span><span class="s"> </span><span class="se">\t</span><span class="s"> </span><span class="si">%g</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_suncoord</span><span class="p">:</span>
			<span class="k">print</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s"> </span><span class="se">\t</span><span class="s"> </span><span class="si">%g</span><span class="s"> </span><span class="se">\t</span><span class="s"> </span><span class="si">%g</span><span class="s"> </span><span class="se">\t</span><span class="s"> </span><span class="si">%g</span><span class="s"> </span><span class="se">\t</span><span class="s"> </span><span class="si">%g</span><span class="s"> </span><span class="se">\t</span><span class="s"> </span><span class="si">%g</span><span class="se">\t</span><span class="s"> </span><span class="si">%g</span><span class="s"> </span><span class="se">\t</span><span class="s"> </span><span class="si">%g</span><span class="s"> </span><span class="se">\t</span><span class="s"> </span><span class="si">%g</span><span class="s"> </span><span class="se">\n</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">,</span>\
																	<span class="bp">self</span><span class="o">.</span><span class="n">X_sun</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">X_sun</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">180.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">X_sun</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mf">180.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
		<span class="k">pass</span></div>
<div class="viewcode-block" id="Cloud.size_function"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud.size_function">[docs]</a>	<span class="k">def</span> <span class="nf">size_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Compute the size in a very wide range of cloud sizes  :math:`[s_1,s_2] pc`, from random numbers following</span>
<span class="sd">		the probability distribution function coming from the cloud size function eq.(4) of</span>
<span class="sd">		`Puglisi+ 2017 &lt;http://arxiv.org/abs/1701.07856&gt;`_.</span>
<span class="sd">		We split it  in two parts :</span>

<span class="sd">		- if :math:`L&gt;s_0 `  a decreasing power-law distribution has been assumed with spectral index :math:`alpha_L=0.8` (see Heyer Dame 2015).</span>
<span class="sd">		- Otherwise  In the outer Galaxy a lower spectral index has been measured  :math:`alpha_L=3.3`, whereas in the inner Galaxy a steeper one  :math:`alpha_L=3.9`.</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">s1</span><span class="o">=</span><span class="nb">globals</span><span class="p">()[</span><span class="s">&#39;L1&#39;</span><span class="p">]</span>
		<span class="n">s0</span><span class="p">,</span><span class="n">s2</span><span class="o">=</span><span class="nb">globals</span><span class="p">()[</span><span class="s">&#39;L0&#39;</span><span class="p">],</span><span class="nb">globals</span><span class="p">()[</span><span class="s">&#39;L2&#39;</span><span class="p">]</span>
		<span class="n">alpha1</span><span class="o">=</span><span class="mf">0.8</span>

		<span class="k">if</span> <span class="n">R</span><span class="o">&lt;</span><span class="mf">8.3</span><span class="p">:</span>
			<span class="n">alpha2</span><span class="o">=</span><span class="mf">3.9</span>
		<span class="k">else</span> <span class="p">:</span>
			<span class="n">alpha2</span><span class="o">=</span><span class="mf">3.3</span>

		<span class="c">#normalization constant such that Integral(dP)=1 in [sizemin,sizemax]</span>
		<span class="n">k2</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span>  <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">alpha1</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">*</span><span class="n">s1</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">alpha1</span><span class="o">-</span><span class="n">alpha2</span><span class="p">)</span> <span class="o">*</span><span class="p">(</span> <span class="n">s1</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha1</span> <span class="p">)</span><span class="o">-</span> <span class="n">s0</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha1</span><span class="p">)</span> <span class="p">)</span> \
			<span class="o">+</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span> <span class="n">alpha2</span> <span class="p">)</span><span class="o">*</span> <span class="p">(</span><span class="n">s2</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha2</span><span class="p">)</span><span class="o">-</span> <span class="n">s1</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha2</span><span class="p">)))</span>
		<span class="n">k1</span><span class="o">=</span><span class="n">s1</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">alpha1</span><span class="o">-</span><span class="n">alpha2</span><span class="p">)</span> <span class="o">*</span> <span class="n">k2</span>
		<span class="n">X10</span>	<span class="o">=</span>	<span class="n">k1</span><span class="o">/</span><span class="p">(</span><span class="n">alpha1</span><span class="o">+</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">s1</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha1</span> <span class="p">)</span><span class="o">-</span> <span class="n">s0</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha1</span><span class="p">))</span>
		<span class="n">X21</span>	<span class="o">=</span>	<span class="n">k2</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">alpha2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">s2</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha2</span><span class="p">)</span><span class="o">-</span> <span class="n">s1</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha2</span><span class="p">))</span>

		<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">X10</span><span class="p">:</span>
			<span class="k">return</span> <span class="p">((</span><span class="n">alpha1</span><span class="o">+</span><span class="mf">1.</span><span class="p">)</span><span class="o">/</span><span class="n">k1</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">s0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha1</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha1</span><span class="p">))</span>
		<span class="k">else</span> <span class="p">:</span>
			<span class="k">return</span>  <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha2</span><span class="p">)</span><span class="o">/</span><span class="n">k2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">X10</span><span class="p">)</span>  <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha2</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha2</span><span class="p">))</span>
</div>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">idcloud</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">em</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">idcloud</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">=</span><span class="p">[</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">has_suncoord</span><span class="o">=</span><span class="bp">False</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">size</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">em</span> <span class="ow">is</span>  <span class="bp">None</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">emissivity</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">size_function</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">=</span><span class="n">size</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="o">=</span><span class="n">em</span>
</div>
<div class="viewcode-block" id="Cloud_Population"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population">[docs]</a><span class="k">class</span> <span class="nc">Cloud_Population</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	class encoding  a list of `Clouds` objects. It is initialized by setting the total</span>
<span class="sd">	number of clouds and the geometry you may want to distribute them.</span>
<span class="sd">	It contains `N_clouds` :class:`Cloud` objects.</span>
<span class="sd">	&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Cloud_Population.cartesianize_coordinates"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population.cartesianize_coordinates">[docs]</a>	<span class="k">def</span> <span class="nf">cartesianize_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">array</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		convert arrays of cylindrical ( spherical if a Spherical distribution is chosen  ) coordinates to cartesian ones.</span>
<span class="sd">		It exploits :mod:`astropy` routines.</span>
<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">return</span> <span class="n">coord</span><span class="o">.</span><span class="n">Galactocentric</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
</div>
	<span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">clouds</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_seed</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>

		<span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">high</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">=</span><span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">a</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">==</span><span class="s">&#39;Spherical&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>

			<span class="n">v</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">high</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">v</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span>

			<span class="n">coord_array</span><span class="o">=</span><span class="n">coord</span><span class="o">.</span><span class="n">PhysicsSphericalRepresentation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">rad</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">rad</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kpc</span> <span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">cartesian_galactocentric</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesianize_coordinates</span><span class="p">(</span><span class="n">coord_array</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">heliocentric_coordinates</span><span class="p">()</span>

			<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">latit</span><span class="p">,</span><span class="n">longit</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">d_sun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">x</span><span class="o">&lt;=</span><span class="mf">0.</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">high</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
					<span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
				<span class="n">c</span><span class="o">=</span><span class="n">Cloud</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">em</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
				<span class="n">c</span><span class="o">.</span><span class="n">assign_sun_coord</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">latit</span><span class="p">,</span><span class="n">longit</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">clouds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">*</span><span class="mf">0.</span>
			<span class="n">rbar</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">==</span><span class="s">&#39;Axisymmetric&#39;</span><span class="p">:</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_seed</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
				<span class="n">negs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_less</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span>
				<span class="c">#central molecular zone</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">negs</span><span class="o">.</span><span class="n">mask</span><span class="p">]</span><span class="o">=</span><span class="mf">0.</span>
			<span class="k">elif</span> 	<span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">==</span><span class="s">&#39;LogSpiral&#39;</span><span class="p">:</span>
				<span class="c">#the bar is assumed axisymmetric and with an inclination angle phi0~25 deg as</span>
				<span class="c">#it has been measured by  Fux et al. 1999</span>
				<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">deg2rad</span>
				<span class="n">phi_0</span><span class="o">=</span><span class="n">deg2rad</span><span class="p">(</span><span class="mf">25.</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">+=</span><span class="n">phi_0</span>
				<span class="n">subsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">/</span><span class="mi">10</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">subsize</span><span class="p">]</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R_params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="n">subsize</span><span class="p">)</span>
				<span class="c">#np.random.uniform(low=0.,high=8.,size=self.n/4)</span>
				<span class="n">rscale</span><span class="o">=</span><span class="n">rbar</span><span class="o">/</span><span class="mf">1.5</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">subsize</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">subsize</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">log_spiral_radial_distribution2</span><span class="p">(</span>\
																<span class="n">rbar</span><span class="p">,</span><span class="n">phi_0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="n">subsize</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R_params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">R_params</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
				<span class="c">#self.r[subsize:self.n]=log_spiral_radial_distribution(self.phi[subsize:self.n],rbar,phi_0)</span>
				<span class="c">#simulate the bar</span>
				<span class="n">arr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_less</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span><span class="n">rbar</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">arr</span><span class="o">.</span><span class="n">mask</span><span class="p">]</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">rscale</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">arr</span><span class="o">.</span><span class="n">mask</span><span class="p">])))</span>
				<span class="n">negs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_less</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span>
				<span class="c">#central molecular zone</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">negs</span><span class="o">.</span><span class="n">mask</span><span class="p">]</span><span class="o">=</span><span class="mf">0.</span>

			<span class="c">#the thickness of the Galactic plane is function of the Galactic Radius roughly as ~ 100 pc *cosh((x/R0) ), with R0~10kpc</span>
			<span class="c"># for reference see fig.6 of Heyer and Dame, 2015</span>
			<span class="n">sigma_z0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z_distr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">R_z0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z_distr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

			<span class="n">sigma_z</span><span class="o">=</span><span class="k">lambda</span> <span class="n">R</span><span class="p">:</span> <span class="n">sigma_z0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">((</span><span class="n">R</span><span class="o">/</span><span class="n">R_z0</span><span class="p">))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zeta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">*</span><span class="mf">0.</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_seed</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">zeta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">sigma_z</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">clouds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Cloud</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">zeta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">em</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
			<span class="n">coord_array</span><span class="o">=</span><span class="n">coord</span><span class="o">.</span><span class="n">CylindricalRepresentation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kpc</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">rad</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">zeta</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kpc</span> <span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">cartesian_galactocentric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesianize_coordinates</span><span class="p">(</span><span class="n">coord_array</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">heliocentric_coordinates</span><span class="p">()</span>

			<span class="k">for</span> <span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">latit</span><span class="p">,</span><span class="n">longit</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clouds</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">d_sun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="p">):</span>
				<span class="n">c</span><span class="o">.</span><span class="n">assign_sun_coord</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">latit</span><span class="p">,</span><span class="n">longit</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="p">)</span>


<div class="viewcode-block" id="Cloud_Population.compute_healpix_vec"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population.compute_healpix_vec">[docs]</a>	<span class="k">def</span> <span class="nf">compute_healpix_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		convert galactic latitude and longitude positions  in :mod:`healpy` mapping quantinties: position vectors.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">rtod</span><span class="o">=</span><span class="mf">180.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
		<span class="n">b_h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span>
		<span class="n">l_h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span>
		<span class="n">vec</span><span class="o">=</span><span class="n">hp</span><span class="o">.</span><span class="n">ang2vec</span><span class="p">(</span><span class="n">b_h</span><span class="p">,</span><span class="n">l_h</span><span class="p">)</span>

		<span class="k">return</span> <span class="n">vec</span></div>
<div class="viewcode-block" id="Cloud_Population.get_pop_emissivities_sizes"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population.get_pop_emissivities_sizes">[docs]</a>	<span class="k">def</span> <span class="nf">get_pop_emissivities_sizes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Looping into the clouds of this class it returns the emissivity and size of each cloud.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">sizes</span><span class="p">,</span><span class="n">emiss</span><span class="o">=</span><span class="p">[],[]</span>
		<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clouds</span><span class="p">:</span>
			<span class="n">sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
			<span class="n">emiss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>
		<span class="k">return</span>  <span class="n">emiss</span><span class="p">,</span> <span class="n">sizes</span></div>
<div class="viewcode-block" id="Cloud_Population.heliocentric_coordinates"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population.heliocentric_coordinates">[docs]</a>	<span class="k">def</span> <span class="nf">heliocentric_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		convert Galactocentric coordinates to heliocentric ones</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">g</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cartesian_galactocentric</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">Galactic</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">d_sun</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">kpc</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">rad</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">rad</span></div>
<div class="viewcode-block" id="Cloud_Population.initialize_cloud_population_from_output"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population.initialize_cloud_population_from_output">[docs]</a>	<span class="k">def</span> <span class="nf">initialize_cloud_population_from_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		read from an hdf5 output file the cloud catalog and assign values</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">clouds</span><span class="o">=</span><span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">read_pop_fromhdf5</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
			<span class="n">zipped</span><span class="o">=</span><span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">d_sun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">2</span><span class="p">:</span>
			<span class="n">zipped</span><span class="o">=</span><span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">zeta</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">d_sun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">latit</span><span class="p">,</span><span class="n">longit</span> <span class="ow">in</span> <span class="n">zipped</span><span class="p">:</span>
			<span class="n">c</span><span class="o">=</span><span class="n">Cloud</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">l</span><span class="p">,</span><span class="n">em</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>
			<span class="n">c</span><span class="o">.</span><span class="n">assign_sun_coord</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">latit</span><span class="p">,</span><span class="n">longit</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">clouds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
			<span class="n">c</span><span class="o">=</span><span class="bp">None</span>
		<span class="k">pass</span></div>
<div class="viewcode-block" id="Cloud_Population.plot_histogram_population"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population.plot_histogram_population">[docs]</a>	<span class="k">def</span> <span class="nf">plot_histogram_population</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">figname</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Makes histograms of all over the population of clouds to check the probability</span>
<span class="sd">		density functions (PDF) of the coordinates :math:`R_{gal}, z, d_{\odot}, \ell`.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">h</span><span class="p">,</span><span class="n">edges</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
		<span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">))])</span>
		<span class="n">area</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">))])</span>
		<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>

		<span class="c">#plt.subplot(2,3,1)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
		<span class="n">h</span><span class="p">,</span><span class="n">bins</span><span class="p">,</span><span class="n">p</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">histtype</span><span class="o">=</span><span class="s">&#39;stepfilled&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;Bin =0.1 kpc&#39;</span><span class="p">)</span>
		<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
		<span class="n">xmajorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
		<span class="n">xmajorFormatter</span> <span class="o">=</span> <span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%d</span><span class="s">&#39;</span><span class="p">)</span>
		<span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">xmajorLocator</span><span class="p">)</span>
		<span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">xmajorFormatter</span><span class="p">)</span>
		<span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>

		<span class="c">#ymajorFormatter = FormatStrFormatter(&#39;%1&#39;)</span>
		<span class="c">#ax.yaxis.set_major_formatter(ymajorFormatter)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">r&#39;$R_{gal}\,$ [kpc]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

		<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">numpoints</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;size&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">}</span> <span class="p">)</span>
		<span class="c">#plt.ylabel(&#39;N per bin &#39;+r&#39;$(\times 10^5)$&#39;,fontsize=17)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;PDF&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
		<span class="n">radtodeg</span><span class="o">=</span><span class="mf">180.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">==</span><span class="s">&#39;Spherical&#39;</span><span class="p">:</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">),</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">histtype</span><span class="o">=</span><span class="s">&#39;stepfilled&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">r&#39;$\cos(\theta )\, $ &#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zeta</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">histtype</span><span class="o">=</span><span class="s">&#39;stepfilled&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;Bin = 5 pc&#39;</span><span class="p">)</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">numpoints</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;size&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">}</span> <span class="p">)</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Vertical position [pc] &#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">])</span>
			<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.01</span><span class="p">])</span>
			<span class="n">xmajorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
			<span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
			<span class="n">xmajorFormatter</span> <span class="o">=</span> <span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%d</span><span class="s">&#39;</span><span class="p">)</span>
			<span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">xmajorLocator</span><span class="p">)</span>
			<span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">xmajorFormatter</span><span class="p">)</span>
			<span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
			<span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="o">.</span><span class="mo">005</span><span class="p">))</span>
			<span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="o">.</span><span class="mo">001</span><span class="p">))</span>


			<span class="n">ymajorFormatter</span> <span class="o">=</span> <span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%1.1e</span><span class="s">&#39;</span><span class="p">)</span>
			<span class="c">#ax.yaxis.set_major_formatter(ymajorFormatter)</span>

		<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d_sun</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">histtype</span><span class="o">=</span><span class="s">&#39;stepfilled&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;Bin =0.1 kpc&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">numpoints</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;size&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">}</span> <span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Heliocentric Distance [kpc]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>
		<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
		<span class="n">xmajorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
		<span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
		<span class="n">xmajorFormatter</span> <span class="o">=</span> <span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%d</span><span class="s">&#39;</span><span class="p">)</span>
		<span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">xmajorLocator</span><span class="p">)</span>
		<span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">xmajorFormatter</span><span class="p">)</span>
		<span class="n">ax3</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>

		<span class="n">ymajorFormatter</span> <span class="o">=</span> <span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%1.1e</span><span class="s">&#39;</span><span class="p">)</span>
		<span class="c">#ax.yaxis.set_major_formatter(ymajorFormatter)</span>
		<span class="c">#plt.ylabel(&#39;N per bin &#39;+r&#39;$(\times 10^5)$&#39;,fontsize=17)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;PDF&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>


		<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">m</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span> <span class="o">&gt;=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">l</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="o">*</span><span class="mf">0.</span>
		<span class="n">l</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span>
		<span class="n">l</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">l</span><span class="o">*</span><span class="n">radtodeg</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">72</span><span class="p">),</span><span class="n">normed</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">histtype</span><span class="o">=</span><span class="s">&#39;stepfilled&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;Bin = 5 deg &#39;</span><span class="p">)</span>
		<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
		<span class="n">xmajorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
		<span class="n">xminorLocator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
		<span class="n">xmajorFormatter</span> <span class="o">=</span> <span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%d</span><span class="s">&#39;</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">xmajorLocator</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">xmajorFormatter</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">xminorLocator</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="o">.</span><span class="mo">005</span><span class="p">))</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="o">.</span><span class="mo">001</span><span class="p">))</span>
		<span class="n">ymajorFormatter</span> <span class="o">=</span> <span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%1.1e</span><span class="s">&#39;</span><span class="p">)</span>
		<span class="c">#ax.yaxis.set_major_formatter(ymajorFormatter)</span>

		<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Galactic Longitude [deg] &#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

		<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">numpoints</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;size&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">}</span> <span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span><span class="o">-</span><span class="mi">180</span><span class="p">])</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.02</span><span class="p">])</span>

		<span class="k">if</span> <span class="n">figname</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Cloud_Population.plot_radial"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population.plot_radial">[docs]</a>	<span class="k">def</span> <span class="nf">plot_radial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">ylabel</span><span class="p">,</span><span class="n">figname</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Plot a quantity `X` which may variates across the Galactic radius :math:`R_{gal}`.</span>
<span class="sd">		(e.g.  the midplane thickness, the emissivity profile,etc...)</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">color</span><span class="o">+</span><span class="s">&#39;-&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">r&#39;$R_{gal}\, \mathrm{[kpc]}$ &#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">figname</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Cloud_Population.plot_3d_population"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population.plot_3d_population">[docs]</a>	<span class="k">def</span> <span class="nf">plot_3d_population</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">figname</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Makes density contour plots of all the cloud population</span>
<span class="sd">		&quot;&quot;&quot;</span>

		<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">gridspec</span><span class="p">,</span><span class="n">colors</span>
		<span class="n">x0</span>	<span class="o">=</span>	<span class="bp">self</span><span class="o">.</span><span class="n">cartesian_galactocentric</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">value</span>
		<span class="n">x1</span>	<span class="o">=</span>	<span class="bp">self</span><span class="o">.</span><span class="n">cartesian_galactocentric</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">value</span>
		<span class="n">x2</span>	<span class="o">=</span>	<span class="bp">self</span><span class="o">.</span><span class="n">cartesian_galactocentric</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">value</span>
		<span class="n">planes</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;x-y&#39;</span><span class="p">:[</span><span class="n">x0</span><span class="p">,</span><span class="n">x1</span><span class="p">],</span><span class="s">&#39;x-z&#39;</span><span class="p">:[</span><span class="n">x0</span><span class="p">,</span><span class="n">x2</span><span class="p">],</span><span class="s">&#39;y-z&#39;</span><span class="p">:[</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">]}</span>
		<span class="n">c</span><span class="o">=</span><span class="mi">1</span>
		<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
		<span class="n">gs</span>  <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span><span class="c">#width_ratios=[1.5, 2,1.5],height_ratios=[1.5,2,1.5])</span>

		<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">planes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">planes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
			<span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

			<span class="n">xyrange</span><span class="o">=</span><span class="p">[[</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)],[</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)]]</span>
			<span class="n">nybins</span><span class="p">,</span><span class="n">nxbins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span>
			<span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="n">nybins</span><span class="p">,</span><span class="n">nxbins</span><span class="p">]</span>
			<span class="n">thresh</span><span class="o">=</span><span class="mi">2</span><span class="c">#density threshold</span>
			<span class="n">hh</span><span class="p">,</span> <span class="n">locx</span><span class="p">,</span> <span class="n">locy</span> <span class="o">=</span> <span class="n">histogram2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">xyrange</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="n">nybins</span><span class="p">,</span><span class="n">nxbins</span><span class="p">])</span>
			<span class="n">posx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">locx</span><span class="p">)</span>
			<span class="n">posy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">locy</span><span class="p">)</span>
			<span class="n">ind</span> <span class="o">=</span> <span class="p">(</span><span class="n">posx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">posx</span> <span class="o">&lt;=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">posy</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">posy</span> <span class="o">&lt;=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
			<span class="n">hhsub</span> <span class="o">=</span> <span class="n">hh</span><span class="p">[</span><span class="n">posx</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">posy</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="c"># values of the histogram where the points are</span>
			<span class="n">xdat1</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="n">hhsub</span> <span class="o">&lt;</span> <span class="n">thresh</span><span class="p">]</span> <span class="c"># low density points</span>
			<span class="n">ydat1</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="n">hhsub</span> <span class="o">&lt;</span> <span class="n">thresh</span><span class="p">]</span>
			<span class="n">hh</span><span class="p">[</span><span class="n">hh</span> <span class="o">&lt;</span> <span class="n">thresh</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="c"># fill the areas with low density by NaNs</span>
			<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

			<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="s">&#39; [kpc]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">a2</span><span class="o">+</span><span class="s">&#39; [kpc]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">a2</span><span class="o">==</span><span class="s">&#39;z&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">!=</span><span class="s">&#39;Spherical&#39;</span><span class="p">:</span>
				<span class="n">im</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">hh</span><span class="o">.</span><span class="n">T</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s">&#39;jet&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">hhsub</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;gaussian&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s">&#39;upper&#39;</span><span class="p">)</span>
				<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">((</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">))</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">im</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">hh</span><span class="o">.</span><span class="n">T</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s">&#39;jet&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">hhsub</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xyrange</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;gaussian&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s">&#39;upper&#39;</span><span class="p">)</span>
				<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdat1</span><span class="p">,</span> <span class="n">ydat1</span><span class="p">,</span> <span class="s">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;darkblue&#39;</span><span class="p">)</span>
			<span class="n">c</span><span class="o">+=</span><span class="mi">1</span>
		<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
		<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>
		<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">figname</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
<div class="viewcode-block" id="Cloud_Population.print_pop"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population.print_pop">[docs]</a>	<span class="k">def</span> <span class="nf">print_pop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Output on screen the whole Monte-Carlo catalogue of molecular clouds</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="kn">from</span> <span class="nn">utilities.utilities_functions</span> <span class="kn">import</span> <span class="n">bash_colors</span>

		<span class="n">cols</span><span class="o">=</span><span class="n">bash_colors</span><span class="p">()</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s">&quot;###&quot;</span><span class="o">*</span><span class="mi">40</span><span class="p">)</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">blue</span><span class="p">(</span><span class="n">cols</span><span class="o">.</span><span class="n">bold</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="s">&quot; Clouds simulated assuming a &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">+</span><span class="s">&quot; model</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">))</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_sun</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">==</span><span class="s">&#39;Spherical&#39;</span><span class="p">:</span>
				<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot;ID </span><span class="se">\t</span><span class="s"> R </span><span class="se">\t\t</span><span class="s"> PHI  </span><span class="se">\t\t</span><span class="s"> THETA</span><span class="se">\t\t</span><span class="s"> Emissivity </span><span class="se">\t</span><span class="s"> Size </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
				<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot; </span><span class="se">\t</span><span class="s">[kpc]</span><span class="se">\t\t</span><span class="s">[rad]</span><span class="se">\t\t</span><span class="s"> [rad]</span><span class="se">\t\t</span><span class="s">  [K km/s]</span><span class="se">\t</span><span class="s"> [pc]</span><span class="se">\t</span><span class="s"> [kpc] </span><span class="se">\t</span><span class="s"> [deg] </span><span class="se">\t</span><span class="s"> [deg] </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

			<span class="k">else</span><span class="p">:</span>
				<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot;ID </span><span class="se">\t</span><span class="s"> R  </span><span class="se">\t\t</span><span class="s"> PHI</span><span class="se">\t\t</span><span class="s"> Z </span><span class="se">\t\t</span><span class="s"> Emissivity</span><span class="se">\t</span><span class="s"> Size </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
				<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot; </span><span class="se">\t</span><span class="s">[kpc]</span><span class="se">\t\t</span><span class="s">[rad]</span><span class="se">\t\t</span><span class="s">[kpc]</span><span class="se">\t\t</span><span class="s">[K km/s]</span><span class="se">\t</span><span class="s">[pc]</span><span class="se">\t</span><span class="s">[kpc] </span><span class="se">\t</span><span class="s"> [deg] </span><span class="se">\t</span><span class="s"> [deg]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
			<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s">&quot;---&quot;</span><span class="o">*</span><span class="mi">40</span><span class="p">)</span>
		<span class="k">else</span> <span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">==</span><span class="s">&#39;Spherical&#39;</span><span class="p">:</span>
				<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot;ID </span><span class="se">\t</span><span class="s"> R </span><span class="se">\t\t</span><span class="s"> PHI  </span><span class="se">\t\t</span><span class="s"> THETA</span><span class="se">\t\t</span><span class="s"> Emissivity </span><span class="se">\t</span><span class="s"> Size </span><span class="se">\t\t</span><span class="s"> D_sun </span><span class="se">\t\t</span><span class="s"> b </span><span class="se">\t\t</span><span class="s">l</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
				<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot; </span><span class="se">\t</span><span class="s">[kpc]</span><span class="se">\t\t</span><span class="s">[rad]</span><span class="se">\t\t</span><span class="s"> [rad]</span><span class="se">\t\t</span><span class="s">  [K km/s]</span><span class="se">\t</span><span class="s"> [pc]</span><span class="se">\t\t</span><span class="s">[kpc] </span><span class="se">\t\t</span><span class="s"> [deg] </span><span class="se">\t\t</span><span class="s"> [deg]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot;ID </span><span class="se">\t</span><span class="s"> R  </span><span class="se">\t\t</span><span class="s"> PHI</span><span class="se">\t\t</span><span class="s"> Z </span><span class="se">\t\t</span><span class="s"> Emissivity</span><span class="se">\t</span><span class="s"> Size </span><span class="se">\t\t</span><span class="s"> D_sun </span><span class="se">\t\t</span><span class="s"> b </span><span class="se">\t\t</span><span class="s">l</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
				<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot; </span><span class="se">\t</span><span class="s">[kpc]</span><span class="se">\t\t</span><span class="s">[rad]</span><span class="se">\t\t</span><span class="s">[kpc]</span><span class="se">\t\t</span><span class="s">[K km/s]</span><span class="se">\t</span><span class="s">[pc]</span><span class="se">\t\t</span><span class="s">[kpc] </span><span class="se">\t\t</span><span class="s"> [deg] </span><span class="se">\t\t</span><span class="s"> [deg]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
			<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s">&quot;---&quot;</span><span class="o">*</span><span class="mi">40</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clouds</span><span class="p">:</span>
			<span class="n">c</span><span class="o">.</span><span class="n">print_cloudinfo</span><span class="p">()</span>

		<span class="k">pass</span></div>
<div class="viewcode-block" id="Cloud_Population.print_parameters"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population.print_parameters">[docs]</a>	<span class="k">def</span> <span class="nf">print_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		print the parameters set for  the simulation</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">typical_size</span><span class="o">=</span><span class="nb">globals</span><span class="p">()[</span><span class="s">&#39;L1&#39;</span><span class="p">]</span>
		<span class="n">minsize</span><span class="p">,</span><span class="n">maxsize</span><span class="o">=</span><span class="nb">globals</span><span class="p">()[</span><span class="s">&#39;L0&#39;</span><span class="p">],</span><span class="nb">globals</span><span class="p">()[</span><span class="s">&#39;L2&#39;</span><span class="p">]</span>
		<span class="n">emissivity</span><span class="o">=</span><span class="nb">globals</span><span class="p">()[</span><span class="s">&#39;emiss_params&#39;</span><span class="p">]</span>
		<span class="kn">from</span> <span class="nn">utilities.utilities_functions</span> <span class="kn">import</span> <span class="n">bash_colors</span>

		<span class="n">cols</span><span class="o">=</span><span class="n">bash_colors</span><span class="p">()</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s">&quot;###&quot;</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">blue</span><span class="p">(</span><span class="s">&quot;Parameters  to MCMole3D&quot;</span><span class="p">)</span>
		<span class="k">print</span> <span class="s">&quot;---&quot;</span><span class="o">*</span><span class="mi">20</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot;Model</span><span class="se">\t\t\t\t</span><span class="s">....</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">),</span><span class="n">cols</span><span class="o">.</span><span class="n">bold</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot;#clouds</span><span class="se">\t\t\t\t</span><span class="s">....</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">),</span><span class="n">cols</span><span class="o">.</span><span class="n">bold</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot;Molecular Ring [location,width]</span><span class="se">\t</span><span class="s">....</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">),</span><span class="n">cols</span><span class="o">.</span><span class="n">bold</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%g</span><span class="s">,</span><span class="si">%g</span><span class="se">\t</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R_params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">R_params</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span><span class="s">&quot;kpc&quot;</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot;Central Midplane Thickness</span><span class="se">\t</span><span class="s">....</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">),</span><span class="n">cols</span><span class="o">.</span><span class="n">bold</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%g</span><span class="se">\t</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z_distr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">)),</span><span class="s">&quot;pc&quot;</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot;Radius of the Galactic Bar </span><span class="se">\t</span><span class="s">....</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">),</span><span class="n">cols</span><span class="o">.</span><span class="n">bold</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%g</span><span class="se">\t</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R_params</span><span class="p">[</span><span class="mi">2</span><span class="p">])),</span><span class="s">&quot;kpc&quot;</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot;Scale Radius Midplane Thickness</span><span class="se">\t</span><span class="s">....</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">),</span><span class="n">cols</span><span class="o">.</span><span class="n">bold</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%g</span><span class="se">\t</span><span class="s">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">z_distr</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="s">&quot;kpc&quot;</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot;Amplitude Emissivity profile</span><span class="se">\t</span><span class="s">....</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">),</span><span class="n">cols</span><span class="o">.</span><span class="n">bold</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%g</span><span class="se">\t</span><span class="s">&quot;</span><span class="o">%</span><span class="n">emissivity</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="s">&quot;K km/s&quot;</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot;Scale Radius Emissivity profile</span><span class="se">\t</span><span class="s">....</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">),</span><span class="n">cols</span><span class="o">.</span><span class="n">bold</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%g</span><span class="se">\t</span><span class="s">&quot;</span><span class="o">%</span><span class="n">emissivity</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="s">&quot;kpc&quot;</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot;Cloud Typical size</span><span class="se">\t\t</span><span class="s">....</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">),</span><span class="n">cols</span><span class="o">.</span><span class="n">bold</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%g</span><span class="se">\t</span><span class="s">&quot;</span><span class="o">%</span><span class="n">typical_size</span><span class="p">),</span><span class="s">&quot;pc&quot;</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">green</span><span class="p">(</span><span class="s">&quot;Cloud size [min,max]</span><span class="se">\t\t</span><span class="s">....</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">),</span><span class="n">cols</span><span class="o">.</span><span class="n">bold</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%g</span><span class="s">,</span><span class="si">%g</span><span class="se">\t</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">minsize</span><span class="p">,</span><span class="n">maxsize</span><span class="p">)),</span><span class="s">&quot;pc&quot;</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s">&quot;###&quot;</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>
		<span class="k">pass</span>
</div>
<div class="viewcode-block" id="Cloud_Population.read_pop_fromhdf5"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population.read_pop_fromhdf5">[docs]</a>	<span class="k">def</span> <span class="nf">read_pop_fromhdf5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Read from an hdf5 file the cloud population. the :class:`Cloud_Population` is thus  initialized by :func:`initialize_cloud_population_from_output`</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">f</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
		<span class="n">g</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="s">&quot;Cloud_Population&quot;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span><span class="n">g</span><span class="p">[</span><span class="s">&quot;R&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">=</span><span class="n">g</span><span class="p">[</span><span class="s">&quot;Phi&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">=</span><span class="n">g</span><span class="p">[</span><span class="s">&quot;Sizes&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="o">=</span><span class="n">g</span><span class="p">[</span><span class="s">&quot;Emissivity&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
		<span class="n">coord_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="o">=</span><span class="n">g</span><span class="p">[</span><span class="s">&quot;Theta&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
			<span class="n">coord_array</span><span class="o">=</span><span class="n">coord</span><span class="o">.</span><span class="n">PhysicsSphericalRepresentation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">rad</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">rad</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kpc</span> <span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">2</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zeta</span><span class="o">=</span><span class="n">g</span><span class="p">[</span><span class="s">&quot;Z&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
			<span class="n">coord_array</span><span class="o">=</span><span class="n">coord</span><span class="o">.</span><span class="n">CylindricalRepresentation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kpc</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">rad</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">zeta</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kpc</span> <span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">d_sun</span><span class="o">=</span><span class="n">g</span><span class="p">[</span><span class="s">&quot;D_sun&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="o">=</span><span class="n">g</span><span class="p">[</span><span class="s">&quot;Gal_longitude&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="o">=</span><span class="n">g</span><span class="p">[</span><span class="s">&quot;Gal_Latitude&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">healpix_vecs</span><span class="o">=</span><span class="n">g</span><span class="p">[</span><span class="s">&quot;Healpix_Vec&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">cartesian_galactocentric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesianize_coordinates</span><span class="p">(</span><span class="n">coord_array</span><span class="p">)</span>
		<span class="kn">from</span> <span class="nn">utilities.utilities_functions</span> <span class="kn">import</span> <span class="n">bash_colors</span>

		<span class="n">cols</span><span class="o">=</span><span class="n">bash_colors</span><span class="p">()</span>
		<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="k">print</span> <span class="n">cols</span><span class="o">.</span><span class="n">bold</span><span class="p">(</span><span class="s">&quot;////// </span><span class="se">\t</span><span class="s"> read from &quot;</span><span class="o">+</span><span class="n">filename</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\t</span><span class="s"> ////////&quot;</span><span class="p">)</span>
		<span class="k">pass</span></div>
<div class="viewcode-block" id="Cloud_Population.set_parameters"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population.set_parameters">[docs]</a>	<span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">radial_distr</span><span class="o">=</span><span class="p">[</span><span class="mf">5.3</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">emissivity</span><span class="o">=</span><span class="p">[</span><span class="mi">60</span><span class="p">,</span><span class="mf">3.59236</span><span class="p">],</span> <span class="n">thickness_distr</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">9.</span><span class="p">],</span>\
							<span class="n">typical_size</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span><span class="n">size_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">30</span><span class="p">]):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Set key-parameters to the population of clouds.</span>

<span class="sd">		- ``radial_distr``:{list}</span>
<span class="sd">			:math:`(\mu_R,FWHM_R, R_{bar})` parameters to the  Galactic radius  distribution of the clouds,</span>
<span class="sd">			assumed Gaussian. The last parameters is the postition of the bar tip.</span>
<span class="sd">			Default  :math:`\mu_R= 5.3 \, ,\sigma_R=FWHM_R/\sqrt(2 \ln 2)= 2.12,\, R_{bar}=3 \, kpc`.</span>
<span class="sd">		- ``thickness_distr``:{list}</span>
<span class="sd">			:math:`(FWHM_{z,0}, R_{z,0})` parameters to the vertical thickness of the Galactic plane</span>
<span class="sd">			increasing in the outer Galaxy with :math:`\sigma(z)=sigma_z(0) *cosh(R/R_{z,0})`.</span>
<span class="sd">			Default  :math:`\sigma_{z,0}=0.1 \, , R_{z,0}=9` kpc.</span>
<span class="sd">		- ``emissivity``:{list}</span>
<span class="sd">			Parameters to the emissivity radial profile, :math:`\epsilon(R)= \epsilon_0 \exp(- R/R_0)`.</span>
<span class="sd">			Default Heyer and Dame 2015 values : :math:`\epsilon_0=60\, K km/s,\, R_0=3.6 \, kpc`.</span>
<span class="sd">		- ``typical_size``: {scalar}</span>
<span class="sd">			Typical size of molecular clouds where we observe the peak in the size distribution function.</span>
<span class="sd">			Default :math:`L_0=10` pc.</span>
<span class="sd">		&quot;&quot;&quot;</span>


		<span class="bp">self</span><span class="o">.</span><span class="n">R_params</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">radial_distr</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">R_params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">z_distr</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">thickness_distr</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">z_distr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/=</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">2.</span><span class="p">)))</span>
		<span class="nb">globals</span><span class="p">()[</span><span class="s">&#39;L1&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">typical_size</span>
		<span class="nb">globals</span><span class="p">()[</span><span class="s">&#39;L0&#39;</span><span class="p">],</span><span class="nb">globals</span><span class="p">()[</span><span class="s">&#39;L2&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">size_range</span>
		<span class="nb">globals</span><span class="p">()[</span><span class="s">&#39;emiss_params&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">emissivity</span>
		<span class="k">pass</span>
</div>
<div class="viewcode-block" id="Cloud_Population.write2hdf5"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population.write2hdf5">[docs]</a>	<span class="k">def</span> <span class="nf">write2hdf5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Write onto an hfd5 file the whole catalogue</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">W</span><span class="p">,</span><span class="n">L</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_pop_emissivities_sizes</span><span class="p">()</span>
		<span class="n">healpix_vecs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">compute_healpix_vec</span><span class="p">()</span>

		<span class="n">f</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
		<span class="n">g</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s">&quot;Cloud_Population&quot;</span><span class="p">)</span>
		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Healpix_Vec&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">healpix_vecs</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">healpix_vecs</span><span class="p">)</span>
		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;R&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Phi&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
			<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Theta&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">2</span><span class="p">:</span>
			<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Z&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zeta</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">zeta</span><span class="p">)</span>

		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Sizes&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">L</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">L</span><span class="p">)</span>
		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Emissivity&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">W</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>
		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;D_sun&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d_sun</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">d_sun</span><span class="p">)</span>
		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Gal_Latitude&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Gal_longitude&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="p">)</span>

		<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="k">pass</span>

</div>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N_clouds</span><span class="p">,</span><span class="n">model</span><span class="p">,</span> <span class="n">randseed</span><span class="o">=</span><span class="bp">False</span> <span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">=</span><span class="n">model</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;Spherical&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Axisymmetric&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;LogSpiral&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">}</span>
		<span class="c">#it&#39;s possible to execute simulations with the same random seed</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">random_seed</span><span class="o">=</span><span class="n">randseed</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">zeta</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">=</span> <span class="n">N_clouds</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">d_sun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span> <span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span>


	<span class="nd">@property</span>
<div class="viewcode-block" id="Cloud_Population.emissivity"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population.emissivity">[docs]</a>	<span class="k">def</span> <span class="nf">emissivity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pop_emissivities_sizes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span></div>
	<span class="nd">@property</span>
<div class="viewcode-block" id="Cloud_Population.sizes"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Cloud_Population.sizes">[docs]</a>	<span class="k">def</span> <span class="nf">sizes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pop_emissivities_sizes</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>

</div></div>
<div class="viewcode-block" id="Collect_Clouds"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Collect_Clouds">[docs]</a><span class="k">class</span> <span class="nc">Collect_Clouds</span><span class="p">(</span><span class="n">Cloud_Population</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	List of `Cloud_population` classes . Read from output</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N_pops</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">Ncl</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span><span class="n">filestring</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

		<span class="nb">super</span><span class="p">(</span><span class="n">Collect_Clouds</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">Ncl</span><span class="p">,</span><span class="n">model</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">Pops</span><span class="o">=</span><span class="p">[]</span>
		<span class="c">#compute the populations</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">N_pops</span><span class="p">):</span>
			<span class="n">pop</span><span class="o">=</span><span class="n">Cloud_Population</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">filestring</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
				<span class="n">pop</span><span class="p">()</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">fname</span><span class="o">=</span><span class="n">filestring</span><span class="o">+</span><span class="s">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">+</span><span class="s">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;.hdf5&#39;</span>
				<span class="n">pop</span><span class="o">.</span><span class="n">initialize_cloud_population_from_output</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">Pops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pop</span><span class="p">)</span>
			<span class="n">pop</span><span class="o">=</span><span class="bp">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">concatenate_arrays</span><span class="p">()</span>



<div class="viewcode-block" id="Collect_Clouds.concatenate_arrays"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Collect_Clouds.concatenate_arrays">[docs]</a>	<span class="k">def</span> <span class="nf">concatenate_arrays</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Concatenate arrays of several :class:`Cloud_Population` objects  to process all of these quantities together</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">r</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">Pops</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">phi</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">Pops</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">d_sun</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">d_sun</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">Pops</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">lat</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">Pops</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">long</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">Pops</span><span class="p">])</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">theta</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">Pops</span><span class="p">])</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">2</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zeta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">zeta</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">Pops</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">get_pop_emissivities_sizes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">Pops</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">get_pop_emissivities_sizes</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">Pops</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="Collect_Clouds.write2hdf5"><a class="viewcode-back" href="../../Documentation.html#cloudmodel.MCMole3D.Collect_Clouds.write2hdf5">[docs]</a>	<span class="k">def</span> <span class="nf">write2hdf5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Write onto an hfd5 file the whole catalogue</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">healpix_vecs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">compute_healpix_vec</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pops</span><span class="p">])</span>
		<span class="n">f</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
		<span class="n">g</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s">&quot;Cloud_Population&quot;</span><span class="p">)</span>
		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Healpix_Vec&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">healpix_vecs</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">healpix_vecs</span><span class="p">)</span>
		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;R&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Phi&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
			<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Theta&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">2</span><span class="p">:</span>
			<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Z&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zeta</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">zeta</span><span class="p">)</span>

		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Sizes&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Emissivity&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>
		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;D_sun&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d_sun</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">d_sun</span><span class="p">)</span>
		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Gal_Latitude&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
		<span class="n">g</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s">&#39;Gal_longitude&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">h5</span><span class="o">.</span><span class="n">h5t</span><span class="o">.</span><span class="n">IEEE_F64BE</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="p">)</span>

		<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="k">pass</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          
          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="../../search.html" method="get">
            <input type="text" name="q" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../../genindex.html" title="General Index"
             >index</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2017, Giuseppe Puglisi.
      Last updated on Jan 31, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>